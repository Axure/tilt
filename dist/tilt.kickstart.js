// Tilt v1.0.0 - A micro script that simulates touch feedback on HTML elements.
// Copyright (c) 2015 Rik Schennink - http://rikschennink.github.io/tilt/
// License: MIT - http://www.opensource.org/licenses/mit-license.php
!function(t,e,n){"undefined"!=typeof module&&module.exports?module.exports=e(t):"function"==typeof define&&define.amd?define(e(t)):t.Tile=e(t)}(this,function(t,e){"use strict";function n(t,e){return t.hasOwnProperty(e)}function i(t,e){return-1!==e.indexOf(t.type)}function o(t,e,n){e.forEach(function(e){t.addEventListener(e,n,!1)})}function r(t,e,n){e.forEach(function(e){t.removeEventListener(e,n,!1)})}function a(t){return 0===t.type.indexOf("touch")&&(t=t.touches[0]||t.changedTouches[0]),{x:t.pageX,y:t.pageY}}function s(e){var n=e.getBoundingClientRect(),i=e&&e.ownerDocument,o=i.documentElement;return{top:n.top+t.pageYOffset-o.clientTop,left:n.left+t.pageXOffset-o.clientLeft,width:n.width,height:n.height}}function u(t){return/transform/i.test(t)}function h(t){var e,n={};return(t.getAttribute("style")||"").split(";").filter(function(t){return t.length}).map(function(t){e=t.split(":"),n[e[0]]=e[1]}),n}function l(t,e){var i,o="",r=h(t);for(i in r)n(r,i)&&(o+=i+":"+r[i]+";");for(i in e)n(e,i)&&(o+=i+":"+e[i]+";",u(i)&&(o+="-webkit-"+i+":"+e[i]+";"));t.style.cssText=o}function p(t){return t.map(function(t){return t.name+"("+t.value+")"}).join(" ")}function c(t,e){var i,o={},r=e||{};for(i in t)n(t,i)&&(o[i]="undefined"==typeof r[i]?t[i]:r[i]);return o}function d(t){return"none"===t?"50% 50%":t}function f(t){return/(left|right|center)/i.test(t)}function m(t){return/(top|bottom|center)/i.test(t)}function v(t,e,n){return Math.max(e,Math.min(t,n))}function g(t,e){return t.replace("(","("+e+"deg, ")}function y(t){var e=t.getAttribute("data-gradient");return e||(e=window.getComputedStyle(t).getPropertyValue("background-image"),t.setAttribute("data-gradient",e)),e}var _=125,w=".tilt {backface-visibility:hidden;-webkit-backface-visibility: hidden;-webkit-highlight:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-transition:-webkit-transform "+_+"ms;transition:transform "+_+"ms;overflow:hidden;position: relative;}.tilt-shadow-inner {position:absolute !important;opacity:0;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:2147483647 !important;background:linear-gradient(rgba(0,0,0,0), rgba(0,0,0,.25));-webkit-transition:opacity "+_+"ms;transition:opacity "+_+"ms;}",b=document.createElement("style");b.type="text/css",b.appendChild(document.createTextNode(w)),document.head.appendChild(b);var x={DOWN:["touchstart","pointerdown","mousedown"],UP:["touchend","touchcancel","pointerup","mouseup","dragend"]},T={top:180,right:270,bottom:0,left:90},M=function(t,e){this._element=t,this._options=c(M.options,e),this._tapTimeout=null,this._init()};return M.options={pivot:"center",depth:15,perspective:"500px",shadow:"rgba(0,0,0,.25)"},M.prototype={handleEvent:function(t){if(!this._tapTimeout)if(i(t,x.DOWN))this._onPush(t);else{this._onLift();var e=this;clearTimeout(this._tapTimeout),this._tapTimeout=setTimeout(function(){clearTimeout(e._tapTimeout),e._tapTimeout=null},_)}},wraps:function(t){return t===this._element},_init:function(){this._options.shadow&&"none"!==this._options.pivot&&(this._element.innerHTML+='<span class="tilt-shadow-inner"></span>'),o(this._element,x.DOWN,this),this._element.dataset.tileState="ready"},_onPush:function(t){o(document,x.UP,this);var e=a(t),n=s(this._element);this.tilt(e.x-n.left,e.y-n.top)},_onLift:function(){r(document,x.UP,this),this.untilt()},tilt:function(t,e){var n,i,o,r,a,u,h,c,_,w,b,x,M,k=this._options.depth,E=this._options.pivot;x={x:f(E),y:m(E)},n=s(this._element),t="undefined"==typeof t?.5*n.width:t,e="undefined"==typeof e?.5*n.height:e,t=v(t,0,n.width)/n.width,e=v(e,0,n.height)/n.height,r=180*Math.atan2(k,n.height*("center"===E?.5:1))/Math.PI,a=180*Math.atan2(k,n.width*("center"===E?.5:1))/Math.PI,h=x.x?"left"===E?0:"right"===E?1:.5:0,c=x.y?"top"===E?0:"bottom"===E?1:.5:0,i=x.y?(e-c)*("center"===E?2:1)*-r:0,o=x.x?(h-t)*("center"===E?2:1)*-a:0,u="none"===E?1:"center"===E?2*(1-Math.sin(.5+(Math.abs(h-t)+Math.abs(c-e)))):0,_=[{name:"perspective",value:this._options.perspective},{name:"rotateX",value:i+"deg"},{name:"rotateY",value:o+"deg"},{name:"translateZ",value:u*-k+"px"}],this._options.shadow&&"none"!==E&&(b=Math.max(Math.abs(i/r),Math.abs(o/a)),M="center"===E?90+180*Math.atan2(e-c,t-h)/Math.PI:T[E],w=this._element.querySelector(".tilt-shadow-inner"),l(w,{opacity:b,background:g(y(w),M)})),l(this._element,{"transform-origin":d(E),transform:p(_)}),this._element.dataset.tileState="pushed"},untilt:function(){var t,e,n=this._options.pivot;this._options.shadow&&"none"!==n&&(t=this._element.querySelector(".tilt-shadow-inner"),l(t,{opacity:0})),e=[{name:"perspective",value:this._options.perspective},{name:"rotateX",value:"0"},{name:"rotateY",value:"0"},{name:"translateZ",value:"0"}],l(this._element,{"transform-origin":d(n),transform:p(e)}),this._element.dataset.tileState="released"},unload:function(){r(this._element,x.DOWN,this),this._onLift()}},M}),function(t,e,n){t&&t.addEventListener&&("undefined"!=typeof module&&module.exports?module.exports=e(t,require("./tilt")):"function"==typeof define&&define.amd?define(["./tilt"],function(n){e(t,n)}):t.InstaTilt=e(t,t.Tile))}(this,function(t,e,n){"use strict";function i(t,e){return t.getAttribute("data-tilt-"+e)}function o(t){for(var e=0,n=a.length;n>e;e++)if(a[e].element===t)return e;return-1}function r(){s.parse(document)}if(e&&Document){var a=[],s={parse:function(t){var n,r,s;for(n=t.querySelectorAll(".tilt"),s=n.length;s--;)r=n[s],-1===o(r)&&a.push({tile:new e(r,{shadow:!("false"===i(r,"shadow")),pivot:i(r,"pivot")||e.options.pivot,perspective:i(r,"perspective")||e.options.perspective,depth:parseInt(i(r,"depth"),10)||e.options.depth}),element:r})},getTileByElement:function(t){if("string"==typeof t&&(t=document.querySelector(t)),!t)return null;var e=o(t);return e?a[e].tile:null},unload:function(t){var e=o(t),n=a[e].tile;n.unload(),a.splice(e,1)}};return"loading"!==document.readyState?r():document.addEventListener("DOMContentLoaded",r),s}});